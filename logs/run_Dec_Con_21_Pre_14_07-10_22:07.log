/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py --heavyBall --gamma_guess 0.0 --corr 5 --solver dopri5
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=8, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, CVPR=False, graf_layer=1, heavyBall=True, actv_h=None, gamma_guess=0.0, gamma_act='sigmoid', corr=5, corrf=True, sign=1, augment_dim=0, solver='dopri5', tol=0.01, alias='run', output_dim=1, feature_out_index=[1], num_atoms=50)
run
Experiment 07-10_22:07
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 4401733.612428 | MAPE 0.063417 | RMSE 286.583019 | Likelihood -4401732.078722 | KL fp 1.5337 | FP STD 0.4174 | ->nfe   26.75 | <-nfe  423.50
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.058160 | RMSE 306.356895 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.123517 | RMSE 907.185548|
0.1374826580286026,0.12701323628425598,0.10605636984109879
852.1381930180104,938.083151964686,931.3352981069708
0.1374826580286026,0.12701323628425598,0.10605636984109879
852.1381930180104,938.083151964686,931.3352981069708
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.123517|Best Test RMSE 907.185548|
Experiment 07-10_22:07
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 4221536.532447 | MAPE 0.092899 | RMSE 276.908506 | Likelihood -4221533.232677 | KL fp 3.2998 | FP STD 0.6029 | ->nfe   32.00 | <-nfe  377.75
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.067865 | RMSE 282.495382 |
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.111590 | RMSE 870.538859|
0.11958993971347809,0.11504258960485458,0.10013691335916519
813.776535665658,903.1161677768813,894.7238750027855
0.11958993971347809,0.11504258960485458,0.10013691335916519
813.776535665658,903.1161677768813,894.7238750027855
Epoch 0002 [Test seq (cond on sampled tp)] | Best Test MAPE 0.111590|Best Test RMSE 870.538859|
Experiment 07-10_22:07
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 3882816.860815 | MAPE 0.234365 | RMSE 257.933279 | Likelihood -3882810.393752 | KL fp 6.4671 | FP STD 0.6763 | ->nfe   32.00 | <-nfe  679.25
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.101662 | RMSE 240.732581 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.129083 | RMSE 796.887712|
0.13711458444595337,0.12821555137634277,0.1219186931848526
734.7999302531268,830.218457696527,825.6447480605688
Experiment 07-10_22:07
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 3616324.509798 | MAPE 0.501664 | RMSE 242.742955 | Likelihood -3616315.437782 | KL fp 9.0720 | FP STD 0.6159 | ->nfe   32.00 | <-nfe  714.50
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.146108 | RMSE 214.365033 |
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.158227 | RMSE 727.076651|
0.17163798213005066,0.15407100319862366,0.14897312223911285
668.8727223844609,757.6021383285557,754.7550927287606
Experiment 07-10_22:07
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 3312825.975797 | MAPE 0.466827 | RMSE 222.665042 | Likelihood -3312819.159032 | KL fp 6.8168 | FP STD 0.4507 | ->nfe   32.00 | <-nfe  199.25
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.069407 | RMSE 184.421488 |
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.084533 | RMSE 680.197463|
0.09229874610900879,0.08486445993185043,0.07643457502126694
614.4456342915946,713.8337297648521,712.3130237121879
0.09229874610900879,0.08486445993185043,0.07643457502126694
614.4456342915946,713.8337297648521,712.3130237121879
Epoch 0005 [Test seq (cond on sampled tp)] | Best Test MAPE 0.084533|Best Test RMSE 680.197463|
Experiment 07-10_22:07
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 2960539.830319 | MAPE 0.187304 | RMSE 196.606120 | Likelihood -2960535.669649 | KL fp 4.1607 | FP STD 0.4784 | ->nfe   32.00 | <-nfe  146.00
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.043584 | RMSE 155.940174 |
Best Val!
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.057872 | RMSE 603.708420|
0.05764447897672653,0.0598735548555851,0.056097496300935745
535.76816931393,633.6617295529217,641.6953619124888
0.05764447897672653,0.0598735548555851,0.056097496300935745
535.76816931393,633.6617295529217,641.6953619124888
Epoch 0006 [Test seq (cond on sampled tp)] | Best Test MAPE 0.057872|Best Test RMSE 603.708420|
Experiment 07-10_22:07
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 2661053.809885 | MAPE 0.045173 | RMSE 172.594637 | Likelihood -2661049.574927 | KL fp 4.2350 | FP STD 0.4428 | ->nfe   32.00 | <-nfe 2755.25
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.037307 | RMSE 133.423777 |
Best Val!
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.046335 | RMSE 524.882124|
0.04722117260098457,0.05005143955349922,0.041730888187885284
452.94694777644764,560.7666069765567,560.9328168328183
0.04722117260098457,0.05005143955349922,0.041730888187885284
452.94694777644764,560.7666069765567,560.9328168328183
Epoch 0007 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046335|Best Test RMSE 524.882124|
Experiment 07-10_22:07
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 2402606.117095 | MAPE 0.046102 | RMSE 148.909305 | Likelihood -2402602.134146 | KL fp 3.9829 | FP STD 0.3638 | ->nfe   32.00 | <-nfe 1495.25
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.027120 | RMSE 115.225293 |
Best Val!
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.048978 | RMSE 472.865979|
0.051393814384937286,0.05242996662855148,0.04311097413301468
406.957230553777,504.07142351059736,507.5692840637621
Experiment 07-10_22:07
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 2294038.430874 | MAPE 0.041583 | RMSE 136.830884 | Likelihood -2294034.719512 | KL fp 3.7114 | FP STD 0.2716 | ->nfe   32.75 | <-nfe  873.50
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.028829 | RMSE 105.934435 |
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.046309 | RMSE 437.974634|
0.05136600509285927,0.049104537814855576,0.0384569987654686
386.3535055489985,464.4293709758245,463.14102536376544
0.05136600509285927,0.049104537814855576,0.0384569987654686
386.3535055489985,464.4293709758245,463.14102536376544
Epoch 0009 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046309|Best Test RMSE 437.974634|
Experiment 07-10_22:07
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 2160098.756840 | MAPE 0.042210 | RMSE 122.498183 | Likelihood -2160094.823613 | KL fp 3.9332 | FP STD 0.2522 | ->nfe   32.75 | <-nfe 1267.25
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.028824 | RMSE 95.548713 |
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.051761 | RMSE 398.687281|
0.058458112180233,0.05663861334323883,0.04018707200884819
329.28500905370714,433.797367730603,432.979466891907
Experiment 07-10_22:07
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 2112475.654310 | MAPE 0.037891 | RMSE 115.798431 | Likelihood -2112472.238684 | KL fp 3.4156 | FP STD 0.2566 | ->nfe   33.50 | <-nfe  900.50
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.032856 | RMSE 98.597053 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.053285 | RMSE 398.115952|
0.05257884040474892,0.05716797336935997,0.050109680742025375
334.28327012804573,424.8405951059762,435.2239904635313
Experiment 07-10_22:07
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 2079437.072875 | MAPE 0.039188 | RMSE 112.102701 | Likelihood -2079433.818209 | KL fp 3.2547 | FP STD 0.2578 | ->nfe   35.75 | <-nfe  693.50
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.027296 | RMSE 100.741921 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.045700 | RMSE 338.789575|
0.04825581982731819,0.04936680570244789,0.039477668702602386
265.45576962085414,356.8998677850694,394.01308671159643
0.04825581982731819,0.04936680570244789,0.039477668702602386
265.45576962085414,356.8998677850694,394.01308671159643
Epoch 0012 [Test seq (cond on sampled tp)] | Best Test MAPE 0.045700|Best Test RMSE 338.789575|
Experiment 07-10_22:07
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 2049585.675080 | MAPE 0.037142 | RMSE 107.959337 | Likelihood -2049582.250006 | KL fp 3.4251 | FP STD 0.2446 | ->nfe   36.50 | <-nfe  950.75
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.033345 | RMSE 84.486971 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.055730 | RMSE 339.181266|
0.052753981202840805,0.05918334051966667,0.05525171756744385
279.0210845527628,376.19823148840027,362.3244833709144
Experiment 07-10_22:07
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 2034339.142743 | MAPE 0.037153 | RMSE 107.254713 | Likelihood -2034335.403644 | KL fp 3.7391 | FP STD 0.2064 | ->nfe   37.25 | <-nfe  629.00
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.032373 | RMSE 105.466917 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.060319 | RMSE 363.281088|
0.06877342611551285,0.06241341307759285,0.049768827855587006
316.84554843409114,390.7147496895913,382.2829653868977
Experiment 07-10_22:07
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 2057427.587194 | MAPE 0.042626 | RMSE 107.765532 | Likelihood -2057424.496545 | KL fp 3.0906 | FP STD 0.2054 | ->nfe   36.50 | <-nfe  908.00
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.026665 | RMSE 79.923786 |
Best Val!
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.059047 | RMSE 322.025062|
0.06402935832738876,0.06023723632097244,0.05287351831793785
253.24030552767465,350.8627202161837,361.9721588050661
Experiment 07-10_22:07
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 2007516.421097 | MAPE 0.034920 | RMSE 102.504380 | Likelihood -2007513.096638 | KL fp 3.3245 | FP STD 0.2281 | ->nfe   38.00 | <-nfe  813.50
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.027163 | RMSE 84.938109 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.054270 | RMSE 327.498469|
0.05783088505268097,0.05624845251441002,0.04873098433017731
290.7121106008486,332.9329300887793,358.8503670577752
Experiment 07-10_22:07
Epoch 0017 [Train seq (cond on sampled tp)] | Loss 2018986.550726 | MAPE 0.040902 | RMSE 103.700432 | Likelihood -2018983.551765 | KL fp 2.9990 | FP STD 0.2450 | ->nfe   38.00 | <-nfe  611.00
Epoch 0017 [Val seq (cond on sampled tp)] |  MAPE 0.032650 | RMSE 82.590694 |
Epoch 0017 [Test seq (cond on sampled tp)] | MAPE 0.053643 | RMSE 303.484917|
0.05496879294514656,0.05467497557401657,0.051283903419971466
248.60099965858947,321.7280975451165,340.1256546300205
Experiment 07-10_22:07
Epoch 0018 [Train seq (cond on sampled tp)] | Loss 2011314.350440 | MAPE 0.035411 | RMSE 103.642868 | Likelihood -2011311.536725 | KL fp 2.8137 | FP STD 0.2751 | ->nfe   38.00 | <-nfe  790.25
Epoch 0018 [Val seq (cond on sampled tp)] |  MAPE 0.035188 | RMSE 80.433676 |
Epoch 0018 [Test seq (cond on sampled tp)] | MAPE 0.052635 | RMSE 285.700047|
0.05422148481011391,0.05302600562572479,0.050656840205192566
217.71056617674762,314.3212180636236,325.0683581956263
Experiment 07-10_22:07
Epoch 0019 [Train seq (cond on sampled tp)] | Loss 1982316.681770 | MAPE 0.041429 | RMSE 99.330343 | Likelihood -1982313.855318 | KL fp 2.8265 | FP STD 0.2656 | ->nfe   38.00 | <-nfe  649.25
Epoch 0019 [Val seq (cond on sampled tp)] |  MAPE 0.026409 | RMSE 78.253769 |
Best Val!
Epoch 0019 [Test seq (cond on sampled tp)] | MAPE 0.053976 | RMSE 290.654468|
0.05592542141675949,0.05620333552360535,0.04979845881462097
230.65131116850387,315.2984944857809,326.01359969715986
Experiment 07-10_22:07
Epoch 0020 [Train seq (cond on sampled tp)] | Loss 1985762.061542 | MAPE 0.038937 | RMSE 99.441729 | Likelihood -1985759.269300 | KL fp 2.7922 | FP STD 0.2643 | ->nfe   38.00 | <-nfe  798.50
Epoch 0020 [Val seq (cond on sampled tp)] |  MAPE 0.032649 | RMSE 72.190016 |
Epoch 0020 [Test seq (cond on sampled tp)] | MAPE 0.055795 | RMSE 309.294508|
0.0593089759349823,0.0608467273414135,0.04722995311021805
233.22988592266643,343.9852149802372,350.6684242272178
Experiment 07-10_22:07
Epoch 0021 [Train seq (cond on sampled tp)] | Loss 1991759.255752 | MAPE 0.038217 | RMSE 99.404338 | Likelihood -1991756.404120 | KL fp 2.8516 | FP STD 0.2136 | ->nfe   38.00 | <-nfe 1024.25
Epoch 0021 [Val seq (cond on sampled tp)] |  MAPE 0.033068 | RMSE 100.293500 |
Epoch 0021 [Test seq (cond on sampled tp)] | MAPE 0.052266 | RMSE 375.394236|
0.05675115808844566,0.05335177481174469,0.04669433459639549
318.8439199867233,394.1280922809233,413.21069459175425
Experiment 07-10_22:07
Epoch 0022 [Train seq (cond on sampled tp)] | Loss 2037803.830656 | MAPE 0.043922 | RMSE 105.553932 | Likelihood -2037801.337315 | KL fp 2.4933 | FP STD 0.2490 | ->nfe   38.00 | <-nfe  980.00
Epoch 0022 [Val seq (cond on sampled tp)] |  MAPE 0.025664 | RMSE 75.394558 |
Best Val!
Epoch 0022 [Test seq (cond on sampled tp)] | MAPE 0.052911 | RMSE 311.068463|
0.060682523995637894,0.052482426166534424,0.045566823333501816
257.803295290227,336.08370655611975,339.3183884642859
Experiment 07-10_22:07
Epoch 0023 [Train seq (cond on sampled tp)] | Loss 1976978.307471 | MAPE 0.041471 | RMSE 97.812373 | Likelihood -1976975.553083 | KL fp 2.7544 | FP STD 0.2111 | ->nfe   38.00 | <-nfe  897.50
Epoch 0023 [Val seq (cond on sampled tp)] |  MAPE 0.031858 | RMSE 94.566192 |
Epoch 0023 [Test seq (cond on sampled tp)] | MAPE 0.046358 | RMSE 290.897344|
0.04597362503409386,0.04959215596318245,0.043508607894182205
240.83081295538162,299.30048655155906,332.5607322354821
Experiment 07-10_22:07
Epoch 0024 [Train seq (cond on sampled tp)] | Loss 1989815.721658 | MAPE 0.038967 | RMSE 99.252351 | Likelihood -1989812.991261 | KL fp 2.7304 | FP STD 0.2191 | ->nfe   38.75 | <-nfe  968.00
Epoch 0024 [Val seq (cond on sampled tp)] |  MAPE 0.045831 | RMSE 96.459350 |
Epoch 0024 [Test seq (cond on sampled tp)] | MAPE 0.045762 | RMSE 301.205728|
0.04268457368016243,0.04706231877207756,0.047537870705127716
248.03823262503303,308.99896338822884,346.5799871602514
Experiment 07-10_22:07
Epoch 0025 [Train seq (cond on sampled tp)] | Loss 1999021.756681 | MAPE 0.066511 | RMSE 101.136944 | Likelihood -1999019.104520 | KL fp 2.6522 | FP STD 0.2459 | ->nfe   38.00 | <-nfe 1016.00
Epoch 0025 [Val seq (cond on sampled tp)] |  MAPE 0.030398 | RMSE 100.593973 |
Epoch 0025 [Test seq (cond on sampled tp)] | MAPE 0.053339 | RMSE 334.454699|
0.05808538943529129,0.05472608283162117,0.04720626771450043
295.93451028056865,347.7189620404674,359.71062588558596
