/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=8, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, debug=False, heavyBall=False, actv_h=None, gamma_guess=-3.0, gamma_act='sigmoid', corr=-100, corrf=True, sign=1, augment_dim=0, solver='rk4', alias='run', output_dim=1, feature_out_index=[1], num_atoms=50, CVPR=True)
run
Experiment 06-30_23:44
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 4424701.078982 | MAPE 0.065114 | RMSE 287.859995 | Likelihood -4424699.548689 | KL fp 1.5303 | FP STD 0.4721|
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.060741 | RMSE 311.476863 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.131883 | RMSE 914.891957|
0.1469355672597885,0.13610287010669708,0.11261110752820969
860.6492462089303,945.710612449707,938.3160115334279
0.1469355672597885,0.13610287010669708,0.11261110752820969
860.6492462089303,945.710612449707,938.3160115334279
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.131883|Best Test RMSE 914.891957|
Experiment 06-30_23:44
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 4343562.272582 | MAPE 0.069575 | RMSE 283.845138 | Likelihood -4343560.137378 | KL fp 2.1352 | FP STD 0.8768|
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.058709 | RMSE 302.355337 |
Best Val!
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.116270 | RMSE 899.980023|
0.12833869457244873,0.12020676583051682,0.10026455670595169
844.4112593991154,931.2984215599208,924.2303892969545
0.12833869457244873,0.12020676583051682,0.10026455670595169
844.4112593991154,931.2984215599208,924.2303892969545
Epoch 0002 [Test seq (cond on sampled tp)] | Best Test MAPE 0.116270|Best Test RMSE 899.980023|
Experiment 06-30_23:44
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 4156402.511641 | MAPE 0.115034 | RMSE 274.355764 | Likelihood -4156397.696699 | KL fp 4.8149 | FP STD 1.2874|
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.069444 | RMSE 279.992090 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.114101 | RMSE 862.044873|
0.1252092868089676,0.11460576951503754,0.10248897224664688
804.4962709671189,893.0858371399694,888.5525097032814
0.1252092868089676,0.11460576951503754,0.10248897224664688
804.4962709671189,893.0858371399694,888.5525097032814
Epoch 0003 [Test seq (cond on sampled tp)] | Best Test MAPE 0.114101|Best Test RMSE 862.044873|
Experiment 06-30_23:44
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 3855605.404024 | MAPE 0.261980 | RMSE 258.044902 | Likelihood -3855595.782421 | KL fp 9.6216 | FP STD 1.5216|
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.110538 | RMSE 244.370500 |
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.147877 | RMSE 794.831982|
0.16080734133720398,0.14477317035198212,0.13804903626441956
733.3662539959143,825.9562261403446,825.1734666117179
Experiment 06-30_23:44
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 3712745.188590 | MAPE 0.550591 | RMSE 248.586069 | Likelihood -3712730.183663 | KL fp 15.0049 | FP STD 1.5605|
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.159502 | RMSE 228.313629 |
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.192206 | RMSE 749.260207|
0.2108401507139206,0.18931806087493896,0.17645885050296783
685.4083864748081,780.8789118679028,781.493322108385
Experiment 06-30_23:44
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 3722516.405910 | MAPE 0.680632 | RMSE 248.290706 | Likelihood -3722499.700665 | KL fp 16.7052 | FP STD 1.3400|
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.141502 | RMSE 231.642083 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.170334 | RMSE 761.489730|
0.18964655697345734,0.1654178649187088,0.1559389978647232
693.3705944514809,795.4980358240994,795.600559326098
Experiment 06-30_23:44
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 3676589.797324 | MAPE 0.571961 | RMSE 246.511572 | Likelihood -3676574.613594 | KL fp 15.1837 | FP STD 1.1613|
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.117235 | RMSE 240.566600 |
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.153282 | RMSE 787.582235|
0.16754208505153656,0.14666463434696198,0.1456395536661148
724.7372799849612,818.4739992815898,819.5354247987087
Experiment 06-30_23:44
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 3687632.180967 | MAPE 0.490372 | RMSE 247.673837 | Likelihood -3687617.935835 | KL fp 14.2451 | FP STD 1.1261|
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.112211 | RMSE 244.029423 |
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.150087 | RMSE 792.321741|
0.1698388010263443,0.1457812786102295,0.13464175164699554
731.7654166466191,824.460391710845,820.7394151007979
Experiment 06-30_23:44
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 3695067.818349 | MAPE 0.473751 | RMSE 248.139944 | Likelihood -3695053.485833 | KL fp 14.3325 | FP STD 1.2267|
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.114303 | RMSE 243.436321 |
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.151453 | RMSE 790.161491|
0.1638851910829544,0.14972594380378723,0.1407477706670761
726.9836655661529,822.7315023748635,820.7693037632438
Experiment 06-30_23:44
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 3693017.213410 | MAPE 0.490478 | RMSE 247.961734 | Likelihood -3693002.304557 | KL fp 14.9089 | FP STD 1.2600|
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.117452 | RMSE 240.911810 |
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.153667 | RMSE 786.890671|
0.1658499538898468,0.15169896185398102,0.14345188438892365
722.5095155082735,820.6922002188153,817.4702976255468
Experiment 06-30_23:44
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 3687258.770045 | MAPE 0.502907 | RMSE 247.545586 | Likelihood -3687243.145877 | KL fp 15.6242 | FP STD 1.2411|
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.121507 | RMSE 240.025056 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.155421 | RMSE 783.262939|
0.17327237129211426,0.1495041400194168,0.1434861719608307
722.4305113642419,816.1324187899902,811.2258856200287
Experiment 06-30_23:44
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 3686723.296824 | MAPE 0.512870 | RMSE 247.475188 | Likelihood -3686706.960655 | KL fp 16.3362 | FP STD 1.1773|
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.123190 | RMSE 238.787513 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.159383 | RMSE 780.303878|
0.17181949317455292,0.16210071742534637,0.14422889053821564
717.4482995310533,814.3140518252156,809.1492831981006
Experiment 06-30_23:44
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 3683153.933455 | MAPE 0.522478 | RMSE 247.188304 | Likelihood -3683137.050228 | KL fp 16.8832 | FP STD 1.1109|
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.122882 | RMSE 238.226168 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.158664 | RMSE 779.088248|
0.17029941082000732,0.15570849180221558,0.14998337626457214
713.9764526929442,811.2488443751399,812.0394463940776
Experiment 06-30_23:44
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 3685779.513553 | MAPE 0.533284 | RMSE 247.258942 | Likelihood -3685762.091139 | KL fp 17.4224 | FP STD 1.0384|
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.126955 | RMSE 237.877151 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.160264 | RMSE 776.878571|
0.17245468497276306,0.1596064418554306,0.14872993528842926
713.2142034480245,810.8633901589095,806.5581194185575
Experiment 06-30_23:44
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 3681972.804232 | MAPE 0.542520 | RMSE 246.989899 | Likelihood -3681954.648854 | KL fp 18.1554 | FP STD 0.8835|
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.129585 | RMSE 236.638091 |
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.163440 | RMSE 776.348173|
0.1794518679380417,0.1604270190000534,0.1504419893026352
712.0210012703277,810.5240588656206,806.4994575323656
Experiment 06-30_23:44
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 3680039.215044 | MAPE 0.548577 | RMSE 246.867932 | Likelihood -3680020.553623 | KL fp 18.6614 | FP STD 0.7739|
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.130011 | RMSE 235.941300 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.160974 | RMSE 773.757211|
0.17452259361743927,0.1578752100467682,0.15052367746829987
709.5218680562284,806.8197986539498,804.9299658976549
Experiment 06-30_23:44
Epoch 0017 [Train seq (cond on sampled tp)] | Loss 3679252.674172 | MAPE 0.556516 | RMSE 246.761923 | Likelihood -3679233.389240 | KL fp 19.2849 | FP STD 0.7372|
Epoch 0017 [Val seq (cond on sampled tp)] |  MAPE 0.132726 | RMSE 235.986998 |
Epoch 0017 [Test seq (cond on sampled tp)] | MAPE 0.165238 | RMSE 771.174523|
0.18025928735733032,0.16290685534477234,0.152548685669899
705.0442362008216,804.5878214961994,803.8915116481826
Experiment 06-30_23:44
Epoch 0018 [Train seq (cond on sampled tp)] | Loss 3682618.972629 | MAPE 0.563675 | RMSE 246.881706 | Likelihood -3682599.254223 | KL fp 19.7184 | FP STD 0.7823|
Epoch 0018 [Val seq (cond on sampled tp)] |  MAPE 0.132990 | RMSE 234.710768 |
Epoch 0018 [Test seq (cond on sampled tp)] | MAPE 0.165151 | RMSE 771.208747|
0.17847292125225067,0.16158843040466309,0.1553930640220642
706.8178248318303,803.7441290609842,803.0642875884844
Experiment 06-30_23:44
Epoch 0019 [Train seq (cond on sampled tp)] | Loss 3683735.821163 | MAPE 0.566759 | RMSE 246.897097 | Likelihood -3683715.421660 | KL fp 20.3995 | FP STD 0.8365|
Epoch 0019 [Val seq (cond on sampled tp)] |  MAPE 0.133294 | RMSE 235.072745 |
Epoch 0019 [Test seq (cond on sampled tp)] | MAPE 0.167110 | RMSE 770.229344|
0.1888764500617981,0.15960738062858582,0.15284666419029236
706.4761805963453,802.7359855519123,801.4758652011924
Experiment 06-30_23:44
Epoch 0020 [Train seq (cond on sampled tp)] | Loss 3685223.037880 | MAPE 0.567797 | RMSE 247.017077 | Likelihood -3685201.806848 | KL fp 21.2310 | FP STD 0.8733|
Epoch 0020 [Val seq (cond on sampled tp)] |  MAPE 0.133543 | RMSE 235.506071 |
Epoch 0020 [Test seq (cond on sampled tp)] | MAPE 0.164812 | RMSE 771.099172|
0.18033115565776825,0.1624622941017151,0.1516440212726593
705.2035388807972,806.4059151568769,801.688062777537
Experiment 06-30_23:44
Epoch 0021 [Train seq (cond on sampled tp)] | Loss 3681903.366254 | MAPE 0.560809 | RMSE 246.813244 | Likelihood -3681880.676149 | KL fp 22.6901 | FP STD 0.8239|
Epoch 0021 [Val seq (cond on sampled tp)] |  MAPE 0.130186 | RMSE 234.729449 |
Epoch 0021 [Test seq (cond on sampled tp)] | MAPE 0.166151 | RMSE 772.910970|
0.18118946254253387,0.16519759595394135,0.15206581354141235
708.7216484629208,807.0437178368963,802.9675429305969
