/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=8, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, augment_dim=0, solver='rk4', alias='run', output_dim=1, feature_out_index=[1], num_atoms=50, heavyBall=False)
run
Experiment 06-19_17:12
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 4390896.056575 | MAPE 0.063295 | RMSE 286.214716 | Likelihood -4390894.705874 | KL fp 1.3507 | FP STD 0.4945|
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.058127 | RMSE 304.541882 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.119556 | RMSE 903.784238|
0.1317383497953415,0.1238325834274292,0.10309615731239319
848.6126913969647,934.8289282002349,927.9110948792454
0.1317383497953415,0.1238325834274292,0.10309615731239319
848.6126913969647,934.8289282002349,927.9110948792454
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.119556|Best Test RMSE 903.784238|
Experiment 06-19_17:12
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 4160265.905345 | MAPE 0.101995 | RMSE 274.602263 | Likelihood -4160263.080180 | KL fp 2.8252 | FP STD 0.9126|
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.064204 | RMSE 277.308436 |
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.107830 | RMSE 858.711557|
0.11696039140224457,0.10949599742889404,0.09703269600868225
799.9362474597585,888.005489847895,888.1929337142916
0.11696039140224457,0.10949599742889404,0.09703269600868225
799.9362474597585,888.005489847895,888.1929337142916
Epoch 0002 [Test seq (cond on sampled tp)] | Best Test MAPE 0.107830|Best Test RMSE 858.711557|
Experiment 06-19_17:12
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 3781797.088668 | MAPE 0.244386 | RMSE 253.912287 | Likelihood -3781791.669054 | KL fp 5.4196 | FP STD 1.1883|
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.103026 | RMSE 234.450155 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.137402 | RMSE 771.899634|
0.14417903125286102,0.14214585721492767,0.12587973475456238
709.5574104679621,801.8325495388673,804.3089425090336
Experiment 06-19_17:12
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 3445462.431092 | MAPE 0.444904 | RMSE 233.105003 | Likelihood -3445456.010260 | KL fp 6.4208 | FP STD 1.0279|
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.072128 | RMSE 197.606765 |
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.102877 | RMSE 700.042960|
0.10659757256507874,0.10057142376899719,0.1014619991183281
632.0862530145708,729.6956557360062,738.3469712811179
0.10659757256507874,0.10057142376899719,0.1014619991183281
632.0862530145708,729.6956557360062,738.3469712811179
Epoch 0004 [Test seq (cond on sampled tp)] | Best Test MAPE 0.102877|Best Test RMSE 700.042960|
Experiment 06-19_17:12
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 2982254.925476 | MAPE 0.182785 | RMSE 203.067733 | Likelihood -2982251.523131 | KL fp 3.4023 | FP STD 0.6472|
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.028616 | RMSE 160.715982 |
Best Val!
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.059780 | RMSE 608.778593|
0.062387771904468536,0.06168191134929657,0.055271346122026443
542.5134502940917,643.4707161169031,640.351612397439
0.062387771904468536,0.06168191134929657,0.055271346122026443
542.5134502940917,643.4707161169031,640.351612397439
Epoch 0005 [Test seq (cond on sampled tp)] | Best Test MAPE 0.059780|Best Test RMSE 608.778593|
Experiment 06-19_17:12
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 2661805.411399 | MAPE 0.040783 | RMSE 177.199581 | Likelihood -2661801.649303 | KL fp 3.7621 | FP STD 0.6509|
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.031201 | RMSE 149.204486 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.056823 | RMSE 552.166071|
0.062033675611019135,0.05727963149547577,0.0511561818420887
478.6052653283288,593.2189467220345,584.6740010467372
0.062033675611019135,0.05727963149547577,0.0511561818420887
478.6052653283288,593.2189467220345,584.6740010467372
Epoch 0006 [Test seq (cond on sampled tp)] | Best Test MAPE 0.056823|Best Test RMSE 552.166071|
Experiment 06-19_17:12
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 2393309.018567 | MAPE 0.043343 | RMSE 152.441375 | Likelihood -2393305.981435 | KL fp 3.0371 | FP STD 0.5492|
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.027992 | RMSE 114.917905 |
Best Val!
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.046314 | RMSE 435.069892|
0.04887185990810394,0.053459081798791885,0.03660956397652626
359.3853911541202,470.9269947401614,474.89729152733645
0.04887185990810394,0.053459081798791885,0.03660956397652626
359.3853911541202,470.9269947401614,474.89729152733645
Epoch 0007 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046314|Best Test RMSE 435.069892|
Experiment 06-19_17:12
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 2240141.930026 | MAPE 0.036649 | RMSE 135.657586 | Likelihood -2240138.967280 | KL fp 2.9627 | FP STD 0.4381|
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.032086 | RMSE 101.316900 |
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.059049 | RMSE 398.271507|
0.060802802443504333,0.061779145151376724,0.054566219449043274
328.79273724110755,427.06540409520414,438.9563795242074
Experiment 06-19_17:12
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 2157233.103593 | MAPE 0.039291 | RMSE 124.201419 | Likelihood -2157229.900339 | KL fp 3.2033 | FP STD 0.3118|
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.027659 | RMSE 101.014875 |
Best Val!
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.048532 | RMSE 405.862138|
0.04652499035000801,0.050784893333911896,0.04828757047653198
343.88454185234906,429.0156065051713,444.68626580995283
Experiment 06-19_17:12
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 2127693.272108 | MAPE 0.039600 | RMSE 120.369467 | Likelihood -2127690.203563 | KL fp 3.0685 | FP STD 0.3019|
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.031134 | RMSE 96.420572 |
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.064046 | RMSE 398.289579|
0.07220546901226044,0.06341572105884552,0.05651591718196869
323.82883933877787,430.88658600610904,440.1533113586674
Experiment 06-19_17:12
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 2076742.166975 | MAPE 0.035036 | RMSE 115.219629 | Likelihood -2076739.399621 | KL fp 2.7674 | FP STD 0.3086|
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.029452 | RMSE 96.325980 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.056443 | RMSE 372.504940|
0.05780487507581711,0.058424245566129684,0.053099192678928375
311.0014695503865,396.62819097361194,409.885159221458
Experiment 06-19_17:12
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 2063244.491561 | MAPE 0.048586 | RMSE 112.582791 | Likelihood -2063241.708548 | KL fp 2.7830 | FP STD 0.2751|
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.036019 | RMSE 99.884787 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.063147 | RMSE 335.191102|
0.06600916385650635,0.06656179577112198,0.05686872452497482
268.0559060158906,365.79963778002843,371.71776087510267
Experiment 06-19_17:12
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 2037579.280566 | MAPE 0.035416 | RMSE 107.901884 | Likelihood -2037576.478029 | KL fp 2.8025 | FP STD 0.2667|
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.037398 | RMSE 107.614379 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.059935 | RMSE 339.515009|
0.06621671468019485,0.06301791965961456,0.05056925117969513
287.2017066671088,370.81590783028713,360.5274131394172
Experiment 06-19_17:12
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 2000744.348593 | MAPE 0.036522 | RMSE 102.315916 | Likelihood -2000741.485524 | KL fp 2.8631 | FP STD 0.2545|
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.030058 | RMSE 90.008878 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.057284 | RMSE 306.980897|
0.05414256826043129,0.06360797584056854,0.05410127341747284
236.98889906755127,336.3555828658118,347.5982100428597
Experiment 06-19_17:12
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 2039687.084999 | MAPE 0.042817 | RMSE 110.674162 | Likelihood -2039684.439780 | KL fp 2.6452 | FP STD 0.2477|
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.030070 | RMSE 82.769570 |
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.056504 | RMSE 279.256898|
0.05742287635803223,0.05978992208838463,0.05229911580681801
204.67022827893166,305.8707217722873,327.2297429750236
Experiment 06-19_17:12
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 1998920.133790 | MAPE 0.038741 | RMSE 103.764886 | Likelihood -1998917.221557 | KL fp 2.9122 | FP STD 0.2250|
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.030812 | RMSE 95.082222 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.062225 | RMSE 308.589697|
0.06404604017734528,0.06495489925146103,0.05767536908388138
236.00101794007162,322.8206134023972,366.94745877305104
Experiment 06-19_17:12
Epoch 0017 [Train seq (cond on sampled tp)] | Loss 2013847.466969 | MAPE 0.039886 | RMSE 106.767106 | Likelihood -2013844.629384 | KL fp 2.8376 | FP STD 0.2130|
Epoch 0017 [Val seq (cond on sampled tp)] |  MAPE 0.031088 | RMSE 82.536116 |
Epoch 0017 [Test seq (cond on sampled tp)] | MAPE 0.065101 | RMSE 297.317132|
0.06714341789484024,0.06790532916784286,0.06025305762887001
229.56902556747502,328.9911306745214,333.39123976193497
Experiment 06-19_17:12
Epoch 0018 [Train seq (cond on sampled tp)] | Loss 1986275.853554 | MAPE 0.032870 | RMSE 101.325420 | Likelihood -1986273.127673 | KL fp 2.7259 | FP STD 0.2472|
Epoch 0018 [Val seq (cond on sampled tp)] |  MAPE 0.048024 | RMSE 89.996718 |
Epoch 0018 [Test seq (cond on sampled tp)] | MAPE 0.070735 | RMSE 332.714428|
0.06556985527276993,0.07254623621702194,0.07408810406923294
268.37472345118493,357.6272282349318,372.1413331988265
Experiment 06-19_17:12
Epoch 0019 [Train seq (cond on sampled tp)] | Loss 2002344.561451 | MAPE 0.045583 | RMSE 103.804458 | Likelihood -2002341.827981 | KL fp 2.7335 | FP STD 0.2274|
Epoch 0019 [Val seq (cond on sampled tp)] |  MAPE 0.036854 | RMSE 85.896922 |
Epoch 0019 [Test seq (cond on sampled tp)] | MAPE 0.067780 | RMSE 313.020950|
0.07499039173126221,0.0710790753364563,0.05726995691657066
253.11559396103988,349.45197050166996,336.495286928361
Experiment 06-19_17:12
Epoch 0020 [Train seq (cond on sampled tp)] | Loss 1972412.854082 | MAPE 0.035447 | RMSE 98.888638 | Likelihood -1972409.902190 | KL fp 2.9519 | FP STD 0.2142|
Epoch 0020 [Val seq (cond on sampled tp)] |  MAPE 0.032151 | RMSE 88.330252 |
Epoch 0020 [Test seq (cond on sampled tp)] | MAPE 0.065502 | RMSE 325.144455|
0.06804416328668594,0.06824297457933426,0.06021877005696297
263.76100391737214,351.12958345175076,360.54277658829886
Experiment 06-19_17:12
Epoch 0021 [Train seq (cond on sampled tp)] | Loss 1978083.853917 | MAPE 0.031256 | RMSE 100.430136 | Likelihood -1978080.916283 | KL fp 2.9376 | FP STD 0.2073|
Epoch 0021 [Val seq (cond on sampled tp)] |  MAPE 0.024147 | RMSE 87.282430 |
Best Val!
Epoch 0021 [Test seq (cond on sampled tp)] | MAPE 0.059121 | RMSE 303.933423|
0.0610712468624115,0.05806326866149902,0.058229874819517136
257.89402498894776,311.78622233431037,342.120021885595
Experiment 06-19_17:12
Epoch 0022 [Train seq (cond on sampled tp)] | Loss 1983054.307771 | MAPE 0.032927 | RMSE 100.551154 | Likelihood -1983051.316718 | KL fp 2.9911 | FP STD 0.2083|
Epoch 0022 [Val seq (cond on sampled tp)] |  MAPE 0.040505 | RMSE 96.194338 |
Epoch 0022 [Test seq (cond on sampled tp)] | MAPE 0.080255 | RMSE 315.757224|
0.083735391497612,0.07822762429714203,0.0788014754652977
259.1632117267032,332.15477849189523,355.953681590035
Experiment 06-19_17:12
Epoch 0023 [Train seq (cond on sampled tp)] | Loss 1995200.596053 | MAPE 0.047558 | RMSE 102.630675 | Likelihood -1995197.589679 | KL fp 3.0064 | FP STD 0.1788|
Epoch 0023 [Val seq (cond on sampled tp)] |  MAPE 0.028446 | RMSE 91.626732 |
Epoch 0023 [Test seq (cond on sampled tp)] | MAPE 0.060892 | RMSE 298.282364|
0.06112480163574219,0.06165625900030136,0.05989531800150871
233.4891592772564,314.23969503788027,347.11823679043425
Experiment 06-19_17:12
Epoch 0024 [Train seq (cond on sampled tp)] | Loss 1975223.906113 | MAPE 0.037011 | RMSE 99.762600 | Likelihood -1975221.245945 | KL fp 2.6602 | FP STD 0.2453|
Epoch 0024 [Val seq (cond on sampled tp)] |  MAPE 0.028336 | RMSE 80.057432 |
Epoch 0024 [Test seq (cond on sampled tp)] | MAPE 0.069295 | RMSE 285.949308|
0.06385517865419388,0.06657102704048157,0.07745811343193054
221.14799908658455,314.9853295194873,321.71459595424017
Experiment 06-19_17:12
Epoch 0025 [Train seq (cond on sampled tp)] | Loss 1987070.463479 | MAPE 0.035517 | RMSE 101.848326 | Likelihood -1987067.917645 | KL fp 2.5458 | FP STD 0.2392|
Epoch 0025 [Val seq (cond on sampled tp)] |  MAPE 0.024887 | RMSE 75.443021 |
Epoch 0025 [Test seq (cond on sampled tp)] | MAPE 0.057407 | RMSE 285.365009|
0.05348821356892586,0.05714626982808113,0.0615864172577858
223.0897818844467,307.7216553762507,325.2835902139854
