/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=8, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, augment_dim=0, solver='rk4', alias='run', output_dim=1, feature_out_index=[1], num_atoms=50, heavyBall=False)
run
Experiment 06-19_17:29
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 4390895.917931 | MAPE 0.063296 | RMSE 286.214713 | Likelihood -4390894.567213 | KL fp 1.3507 | FP STD 0.4945|
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.058127 | RMSE 304.541856 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.119556 | RMSE 903.784215|
0.13173797726631165,0.12383275479078293,0.10309627652168274
848.6126545721552,934.8289282002349,927.9110612014495
0.13173797726631165,0.12383275479078293,0.10309627652168274
848.6126545721552,934.8289282002349,927.9110612014495
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.119556|Best Test RMSE 903.784215|
Experiment 06-19_17:29
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 4160215.407201 | MAPE 0.102073 | RMSE 274.600297 | Likelihood -4160212.581156 | KL fp 2.8260 | FP STD 0.9128|
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.064209 | RMSE 277.308619 |
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.107843 | RMSE 858.711571|
0.11697136610746384,0.10951440781354904,0.09704400599002838
799.936325590981,888.0056306127794,888.1927577952885
0.11697136610746384,0.10951440781354904,0.09704400599002838
799.936325590981,888.0056306127794,888.1927577952885
Epoch 0002 [Test seq (cond on sampled tp)] | Best Test MAPE 0.107843|Best Test RMSE 858.711571|
Experiment 06-19_17:29
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 3781755.063660 | MAPE 0.244380 | RMSE 253.910290 | Likelihood -3781749.647112 | KL fp 5.4165 | FP STD 1.1879|
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.103000 | RMSE 234.444715 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.137348 | RMSE 771.889627|
0.14411219954490662,0.1420915573835373,0.12584146857261658
709.5404322517498,801.8233907787924,804.3050571766909
Experiment 06-19_17:29
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 3444701.030459 | MAPE 0.444269 | RMSE 233.059988 | Likelihood -3444694.616494 | KL fp 6.4140 | FP STD 1.0271|
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.072035 | RMSE 197.830825 |
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.102391 | RMSE 699.085618|
0.1060083732008934,0.10026408731937408,0.10090083628892899
631.0080724523261,729.0160749256494,737.2327057991934
0.1060083732008934,0.10026408731937408,0.10090083628892899
631.0080724523261,729.0160749256494,737.2327057991934
Epoch 0004 [Test seq (cond on sampled tp)] | Best Test MAPE 0.102391|Best Test RMSE 699.085618|
Experiment 06-19_17:29
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 2980851.210948 | MAPE 0.181950 | RMSE 202.977338 | Likelihood -2980847.801690 | KL fp 3.4093 | FP STD 0.6439|
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.029236 | RMSE 159.372874 |
Best Val!
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.061278 | RMSE 606.792202|
0.06387940049171448,0.06420888006687164,0.05574557185173035
540.0037036910024,641.2445418871025,639.1283615205947
0.06387940049171448,0.06420888006687164,0.05574557185173035
540.0037036910024,641.2445418871025,639.1283615205947
Epoch 0005 [Test seq (cond on sampled tp)] | Best Test MAPE 0.061278|Best Test RMSE 606.792202|
Experiment 06-19_17:29
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 2662865.306519 | MAPE 0.040636 | RMSE 177.302085 | Likelihood -2662861.464140 | KL fp 3.8424 | FP STD 0.6422|
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.031324 | RMSE 144.187703 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.055137 | RMSE 541.658836|
0.06120084971189499,0.054813068360090256,0.04939694330096245
462.02933821890576,585.5797074267516,577.3674631463051
0.06120084971189499,0.054813068360090256,0.04939694330096245
462.02933821890576,585.5797074267516,577.3674631463051
Epoch 0006 [Test seq (cond on sampled tp)] | Best Test MAPE 0.055137|Best Test RMSE 541.658836|
Experiment 06-19_17:29
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 2399442.939675 | MAPE 0.041832 | RMSE 153.125212 | Likelihood -2399439.836388 | KL fp 3.1033 | FP STD 0.5443|
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.028665 | RMSE 116.159243 |
Best Val!
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.049064 | RMSE 449.211532|
0.050595272332429886,0.05192314833402634,0.044673264026641846
367.8531254114881,486.048512239262,493.73295856667295
0.050595272332429886,0.05192314833402634,0.044673264026641846
367.8531254114881,486.048512239262,493.73295856667295
Epoch 0007 [Test seq (cond on sampled tp)] | Best Test MAPE 0.049064|Best Test RMSE 449.211532|
Experiment 06-19_17:29
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 2255862.875222 | MAPE 0.038264 | RMSE 137.474784 | Likelihood -2255860.055058 | KL fp 2.8202 | FP STD 0.4503|
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.027351 | RMSE 97.272416 |
Best Val!
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.054565 | RMSE 391.686449|
0.062509685754776,0.0501176118850708,0.05106917396187782
322.20906208159323,418.8745337210177,433.97575177076425
Experiment 06-19_17:29
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 2132042.001021 | MAPE 0.035216 | RMSE 121.873122 | Likelihood -2132038.885204 | KL fp 3.1158 | FP STD 0.3853|
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.028930 | RMSE 96.890256 |
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.050587 | RMSE 367.517983|
0.05654241517186165,0.05181153491139412,0.0434078574180603
313.2233378517635,376.65532569578784,412.67528472759307
Experiment 06-19_17:29
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 2119613.133012 | MAPE 0.049986 | RMSE 117.877759 | Likelihood -2119609.974324 | KL fp 3.1587 | FP STD 0.3126|
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.028430 | RMSE 96.317240 |
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.055981 | RMSE 363.959971|
0.05950699746608734,0.05658279359340668,0.0518517941236496
294.55241469049275,378.9611622580868,418.3663354346284
Experiment 06-19_17:29
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 2065014.482323 | MAPE 0.042287 | RMSE 113.171835 | Likelihood -2065011.491278 | KL fp 2.9910 | FP STD 0.2953|
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.029763 | RMSE 86.153657 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.055992 | RMSE 323.647758|
0.05835824832320213,0.05924324691295624,0.05037490651011467
249.5576946694892,330.35297174007684,391.03260733601235
Experiment 06-19_17:29
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 2028259.154042 | MAPE 0.034535 | RMSE 108.800138 | Likelihood -2028256.219799 | KL fp 2.9342 | FP STD 0.3119|
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.033017 | RMSE 81.407926 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.063975 | RMSE 315.375308|
0.06646227091550827,0.0676989033818245,0.057765018194913864
261.00933891338065,333.22109308235576,351.8954922984948
Experiment 06-19_17:29
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 2022860.998693 | MAPE 0.036339 | RMSE 106.710070 | Likelihood -2022857.932274 | KL fp 3.0664 | FP STD 0.3016|
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.040114 | RMSE 94.405262 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.065042 | RMSE 304.714438|
0.06900259852409363,0.06687811762094498,0.05924523249268532
242.4129837436518,331.720244049862,340.01008716654275
Experiment 06-19_17:29
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 2005330.580645 | MAPE 0.036060 | RMSE 103.296059 | Likelihood -2005327.322864 | KL fp 3.2578 | FP STD 0.2786|
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.032309 | RMSE 108.116767 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.059523 | RMSE 377.732138|
0.05853967368602753,0.06501209735870361,0.05501747876405716
304.5999681959931,414.3720588130913,414.224388164193
Experiment 06-19_17:29
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 2070515.884586 | MAPE 0.035222 | RMSE 114.145019 | Likelihood -2070512.841148 | KL fp 3.0434 | FP STD 0.2301|
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.033436 | RMSE 92.020283 |
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.061131 | RMSE 342.141173|
0.0607822947204113,0.06463062018156052,0.05798094719648361
263.7905922554859,385.9335070643647,376.69942012830336
Experiment 06-19_17:29
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 2013052.769497 | MAPE 0.031552 | RMSE 104.875579 | Likelihood -2013049.568411 | KL fp 3.2011 | FP STD 0.2086|
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.035526 | RMSE 84.606615 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.065794 | RMSE 335.055276|
0.0689806267619133,0.07092040032148361,0.05747973918914795
259.23172247527884,365.71819325130656,380.21591316645333
Experiment 06-19_17:29
Epoch 0017 [Train seq (cond on sampled tp)] | Loss 2010469.655450 | MAPE 0.042990 | RMSE 104.011254 | Likelihood -2010466.414448 | KL fp 3.2410 | FP STD 0.2052|
Epoch 0017 [Val seq (cond on sampled tp)] |  MAPE 0.025392 | RMSE 94.748397 |
Best Val!
Epoch 0017 [Test seq (cond on sampled tp)] | MAPE 0.059191 | RMSE 340.458997|
0.060905635356903076,0.06467875093221664,0.05198996514081955
270.6308457798187,374.61695019713136,376.1291957226931
