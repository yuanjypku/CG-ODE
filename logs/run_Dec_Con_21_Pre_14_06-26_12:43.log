/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=1, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, debug=False, heavyBall=False, actv_h=None, gamma_guess=-3.0, gamma_act='sigmoid', corr=-100, corrf=True, sign=1, augment_dim=0, solver='rk4', alias='run', output_dim=1, feature_out_index=[1], num_atoms=50, CVPR=False)
run
Experiment 06-26_12:43
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 3383606.191460 | MAPE 0.092830 | RMSE 228.758413 | Likelihood -3383603.023524 | KL fp 3.1679 | FP STD 0.5979|
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.041832 | RMSE 141.027887 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.060103 | RMSE 524.813704|
0.05926379933953285,0.057985804975032806,0.0630592405796051
462.0822437618654,546.884785626735,565.4740820762698
0.05926379933953285,0.057985804975032806,0.0630592405796051
462.0822437618654,546.884785626735,565.4740820762698
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.060103|Best Test RMSE 524.813704|
Experiment 06-26_12:43
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 2328759.019391 | MAPE 0.049998 | RMSE 141.721357 | Likelihood -2328756.519539 | KL fp 2.4999 | FP STD 0.4177|
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.043325 | RMSE 128.311956 |
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.068156 | RMSE 492.990108|
0.06607771664857864,0.07780258357524872,0.060587525367736816
436.7493202627796,526.0159218122584,516.2050827917137
Experiment 06-26_12:43
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 2264724.205991 | MAPE 0.051904 | RMSE 134.443925 | Likelihood -2264722.419512 | KL fp 1.7865 | FP STD 0.5331|
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.097837 | RMSE 131.952195 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.114960 | RMSE 423.540182|
0.1257210075855255,0.11060895025730133,0.10855136811733246
359.116374330801,453.38259919189665,458.12157229277034
Experiment 06-26_12:43
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 2263042.160051 | MAPE 0.093106 | RMSE 130.840800 | Likelihood -2263040.477691 | KL fp 1.6824 | FP STD 0.4761|
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.032931 | RMSE 91.632666 |
Best Val!
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.075607 | RMSE 348.679256|
0.07223381102085114,0.0807105079293251,0.07387692481279373
272.797100080811,386.19740742268067,387.0432590486495
Experiment 06-26_12:43
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 2200402.840512 | MAPE 0.081760 | RMSE 126.148583 | Likelihood -2200401.065089 | KL fp 1.7754 | FP STD 0.4665|
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.045501 | RMSE 118.807083 |
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.061061 | RMSE 422.847446|
0.06067676842212677,0.06201756000518799,0.060487210750579834
354.35350463908213,461.41453704884503,452.7742953172143
Experiment 06-26_12:43
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 2253206.554428 | MAPE 0.132893 | RMSE 132.524604 | Likelihood -2253204.761343 | KL fp 1.7931 | FP STD 0.5062|
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.101261 | RMSE 117.317773 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.113405 | RMSE 379.763036|
0.11483335494995117,0.11683009564876556,0.10855129361152649
346.41955460467295,414.2556954949443,378.6138575448606
Experiment 06-26_12:43
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 2231952.774212 | MAPE 0.203745 | RMSE 129.211683 | Likelihood -2231950.695981 | KL fp 2.0782 | FP STD 0.4814|
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.075636 | RMSE 120.148968 |
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.099140 | RMSE 378.013318|
0.09563741832971573,0.09110032021999359,0.11068178713321686
340.47883331787307,376.75676005879444,416.80436058179623
Experiment 06-26_12:43
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 2250668.548063 | MAPE 0.170899 | RMSE 132.361351 | Likelihood -2250666.140813 | KL fp 2.4072 | FP STD 0.5093|
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.052259 | RMSE 117.956696 |
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.071576 | RMSE 423.675781|
0.07309672236442566,0.06758392602205276,0.07404686510562897
349.98184104678916,457.96124290162373,463.08425934164507
Experiment 06-26_12:43
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 2264768.255191 | MAPE 0.134494 | RMSE 133.267399 | Likelihood -2264765.473093 | KL fp 2.7821 | FP STD 0.3957|
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.048717 | RMSE 112.554197 |
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.064941 | RMSE 436.497766|
0.06294898688793182,0.06543605029582977,0.06643812358379364
374.472921250656,469.4297404830674,465.59063631585207
Experiment 06-26_12:43
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 2162217.545261 | MAPE 0.156012 | RMSE 121.061144 | Likelihood -2162214.775496 | KL fp 2.7698 | FP STD 0.4382|
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.040197 | RMSE 117.214256 |
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.053092 | RMSE 423.096235|
0.05209299549460411,0.05281843617558479,0.05436570942401886
356.4945651759645,465.369443292101,447.42469687646883
0.05209299549460411,0.05281843617558479,0.05436570942401886
356.4945651759645,465.369443292101,447.42469687646883
Epoch 0010 [Test seq (cond on sampled tp)] | Best Test MAPE 0.053092|Best Test RMSE 423.096235|
Experiment 06-26_12:43
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 2206318.152146 | MAPE 0.132219 | RMSE 128.640496 | Likelihood -2206315.519039 | KL fp 2.6331 | FP STD 0.3636|
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.081435 | RMSE 124.080898 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.095044 | RMSE 471.768328|
0.1008482351899147,0.10114726424217224,0.0831369012594223
422.16123622971355,525.3850968575337,467.75865171047343
Experiment 06-26_12:43
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 2189053.393013 | MAPE 0.189150 | RMSE 122.569699 | Likelihood -2189050.791534 | KL fp 2.6015 | FP STD 0.3734|
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.040988 | RMSE 124.552278 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.059301 | RMSE 493.899552|
0.0539436899125576,0.056641824543476105,0.06731750816106796
419.75539752336715,532.0267850400015,529.9164733710398
Experiment 06-26_12:43
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 2240437.294792 | MAPE 0.162050 | RMSE 130.447695 | Likelihood -2240435.142228 | KL fp 2.1526 | FP STD 0.4709|
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.047709 | RMSE 99.108157 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.091999 | RMSE 351.658041|
0.10067719221115112,0.09283174574375153,0.08248724043369293
283.59949202175943,376.7593106016094,394.6153190133399
Experiment 06-26_12:43
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 2130099.081114 | MAPE 0.173256 | RMSE 114.223368 | Likelihood -2130097.074292 | KL fp 2.0068 | FP STD 0.5447|
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.115112 | RMSE 111.422069 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.124046 | RMSE 338.400040|
0.12992756068706512,0.12278400361537933,0.11942747980356216
309.6716633185865,369.8090089830155,335.71944667385594
Experiment 06-26_12:43
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 2095170.424293 | MAPE 0.262083 | RMSE 109.243607 | Likelihood -2095167.898730 | KL fp 2.5256 | FP STD 0.4954|
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.033526 | RMSE 117.571676 |
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.048307 | RMSE 385.826705|
0.05164606496691704,0.04871935769915581,0.04455425217747688
339.49349910933495,413.32500831669984,404.6616063144612
0.05164606496691704,0.04871935769915581,0.04455425217747688
339.49349910933495,413.32500831669984,404.6616063144612
Epoch 0015 [Test seq (cond on sampled tp)] | Best Test MAPE 0.048307|Best Test RMSE 385.826705|
Experiment 06-26_12:43
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 2174004.949613 | MAPE 0.135445 | RMSE 123.302554 | Likelihood -2174002.441150 | KL fp 2.5085 | FP STD 0.5498|
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.041070 | RMSE 95.650989 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.046846 | RMSE 348.012645|
0.051615044474601746,0.045312777161598206,0.04360950365662575
290.2820691801338,395.57807778616854,358.1777884305502
0.051615044474601746,0.045312777161598206,0.04360950365662575
290.2820691801338,395.57807778616854,358.1777884305502
Epoch 0016 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046846|Best Test RMSE 348.012645|
