/nvme/yuanjingyang/CG-ODE/run_models_spring.py
run_models_spring.py
Namespace(save='experiments/', load=None, dataset='spring', datapath='data/', pred_length=48, condition_length=71, features='X,Y,vel_X,vel_Y', feature_out='X,Y', test_K=30, niters=100, lr=0.005, batch_size=320, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=30, rec_layers=1, gen_layers=1, encoder='base', graf_layer=1, cheb_K=2, heavyBall=False, actv_h=None, gamma_guess=-3.0, gamma_act='sigmoid', corr=-100, corrf=True, sign=1, augment_dim=0, solver='rk4', rtol=0.01, atol=0.01, alias='run', output_dim=2, feature_out_index=[0, 1], num_atoms=5)
run
Experiment 09-05_06:33
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 700.546389 | MAPE 4.276538 | RMSE 1.349868 | Likelihood -699.340483 | KL fp 1.2059 | FP STD 0.3331 | ->nfe  188.00 | <-nfe  188.00
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 5.749005 | RMSE 1.112972 | MAE 0.877893 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 2.596258 | RMSE 1.769946| MAE 1.481683|
4.24478006362915,0.9804345965385437,1.0764273405075073,12.201584815979004,1.865385890007019,0.7611189484596252,2.288579225540161,1.8964823484420776,1.7901028394699097,12.585426330566406,2.2510993480682373,1.8244930505752563,0.5420680046081543,0.6637922525405884,9.19822883605957,2.1397855281829834,1.4631563425064087,0.7765663266181946,1.5375858545303345,1.2907665967941284,0.572567880153656,1.3098467588424683,0.6424648761749268,0.8766851425170898,0.9992443919181824,5.485501289367676,1.0961822271347046,3.7777793407440186,0.6920257806777954,1.0575895309448242
2.3900355191963194,1.4996773849689895,0.9737579969241801,1.8073200000077403,1.294597049898711,1.4299397897382293,2.13243563609689,1.6530175244417253,1.6712987744583132,1.6551030344165623,2.107142531554264,1.5083862952247837,1.408235038998848,2.28561047335299,1.5612755364558408,1.2313942471352328,1.6051085873291937,2.138103698784933,1.9760685480675986,2.0482828671120683,1.822698380252744,1.303092255398211,1.5345398730793256,2.2509836589842043,2.134162447665909,1.8166324597675847,2.3426779774866993,1.8579281859957955,1.9944597039425576,1.664422153058508
4.24478006362915,0.9804345965385437,1.0764273405075073,12.201584815979004,1.865385890007019,0.7611189484596252,2.288579225540161,1.8964823484420776,1.7901028394699097,12.585426330566406,2.2510993480682373,1.8244930505752563,0.5420680046081543,0.6637922525405884,9.19822883605957,2.1397855281829834,1.4631563425064087,0.7765663266181946,1.5375858545303345,1.2907665967941284,0.572567880153656,1.3098467588424683,0.6424648761749268,0.8766851425170898,0.9992443919181824,5.485501289367676,1.0961822271347046,3.7777793407440186,0.6920257806777954,1.0575895309448242
2.3900355191963194,1.4996773849689895,0.9737579969241801,1.8073200000077403,1.294597049898711,1.4299397897382293,2.13243563609689,1.6530175244417253,1.6712987744583132,1.6551030344165623,2.107142531554264,1.5083862952247837,1.408235038998848,2.28561047335299,1.5612755364558408,1.2313942471352328,1.6051085873291937,2.138103698784933,1.9760685480675986,2.0482828671120683,1.822698380252744,1.303092255398211,1.5345398730793256,2.2509836589842043,2.134162447665909,1.8166324597675847,2.3426779774866993,1.8579281859957955,1.9944597039425576,1.664422153058508
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 2.596258|Best Test RMSE 1.769946|Best Test MAE 1.481683|
Experiment 09-05_06:33
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 586.555379 | MAPE 3.249275 | RMSE 0.990075 | Likelihood -585.094635 | KL fp 1.4607 | FP STD 0.2854 | ->nfe  188.00 | <-nfe  188.00
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 4.919796 | RMSE 0.926712 | MAE 0.797037 |
Best Val!
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 2.852331 | RMSE 1.774733| MAE 1.510019|
3.2649524211883545,1.512775182723999,0.7639514803886414,22.456789016723633,1.887407660484314,1.2390114068984985,4.268857479095459,1.1919230222702026,0.8635466694831848,5.338170528411865,2.6658852100372314,1.8317450284957886,0.614067554473877,0.46144914627075195,7.751497745513916,3.115455150604248,1.6442111730575562,2.3722176551818848,1.1999096870422363,1.3942822217941284,0.7981160283088684,1.8555128574371338,0.740408718585968,1.006391167640686,0.9765386581420898,8.108020782470703,1.6381710767745972,3.4627716541290283,0.5692030787467957,0.5767044425010681
1.784230131825718,1.7513796272742175,0.9137014344299219,2.2344719925749366,1.3231911061692618,2.245880063714356,1.9794986312603247,1.4868953790346449,1.4764918557681028,1.2262386210280134,1.898599248832153,1.2074865575006621,1.441537825205573,1.64958281300302,1.3866452909542946,1.3328739755814911,1.6554966058768295,2.1862533286643493,1.6005830328346509,1.6242343125691796,2.117229278264861,1.7496761976130126,2.0381018469371863,2.4727977935149297,2.0558144847354765,2.2800111934320175,2.670821400425796,2.141155873204507,2.0538065947468103,1.2573027436727924
Experiment 09-05_06:33
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 555.388790 | MAPE 2.802364 | RMSE 0.940405 | Likelihood -553.927715 | KL fp 1.4611 | FP STD 0.3201 | ->nfe  188.00 | <-nfe  188.00
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 7.593125 | RMSE 0.904951 | MAE 0.802939 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 2.546337 | RMSE 1.433109| MAE 1.205526|
2.553558588027954,1.6158125400543213,0.8863720297813416,12.172879219055176,1.581501841545105,0.6573049426078796,2.4835548400878906,1.3926646709442139,1.7180817127227783,12.982894897460938,1.8071171045303345,1.542456030845642,0.5019912123680115,0.2736940383911133,6.202714443206787,3.141681432723999,1.1122674942016602,1.70512855052948,0.8260486721992493,0.9931256175041199,0.4820602834224701,1.3031768798828125,0.5189788341522217,0.4467603862285614,0.7271260023117065,12.061430931091309,1.2482566833496094,2.1358892917633057,0.3760521113872528,0.9395288825035095
2.02269032944325,1.3696000094433811,0.8489921344666813,1.4011509745144788,1.4088305637641225,1.3337081690255284,1.7887974172048058,1.3188949288373917,1.4074904586848032,1.302426600667048,1.4205784178387506,1.5207376667747337,1.293043750996331,1.1000598912840729,1.3677357909367984,1.1773301881288774,1.1835787429109972,1.9986548668680815,1.3056198260988645,1.3975757948873968,1.3041173637178998,1.3355474069822446,1.4409932524386118,1.1520005054373428,1.8207265358454874,1.6406356811175746,1.715475326707545,1.5889934543549222,1.6272192253124846,1.4000521241430202
2.553558588027954,1.6158125400543213,0.8863720297813416,12.172879219055176,1.581501841545105,0.6573049426078796,2.4835548400878906,1.3926646709442139,1.7180817127227783,12.982894897460938,1.8071171045303345,1.542456030845642,0.5019912123680115,0.2736940383911133,6.202714443206787,3.141681432723999,1.1122674942016602,1.70512855052948,0.8260486721992493,0.9931256175041199,0.4820602834224701,1.3031768798828125,0.5189788341522217,0.4467603862285614,0.7271260023117065,12.061430931091309,1.2482566833496094,2.1358892917633057,0.3760521113872528,0.9395288825035095
2.02269032944325,1.3696000094433811,0.8489921344666813,1.4011509745144788,1.4088305637641225,1.3337081690255284,1.7887974172048058,1.3188949288373917,1.4074904586848032,1.302426600667048,1.4205784178387506,1.5207376667747337,1.293043750996331,1.1000598912840729,1.3677357909367984,1.1773301881288774,1.1835787429109972,1.9986548668680815,1.3056198260988645,1.3975757948873968,1.3041173637178998,1.3355474069822446,1.4409932524386118,1.1520005054373428,1.8207265358454874,1.6406356811175746,1.715475326707545,1.5889934543549222,1.6272192253124846,1.4000521241430202
Epoch 0003 [Test seq (cond on sampled tp)] | Best Test MAPE 2.546337|Best Test RMSE 1.433109|Best Test MAE 1.205526|
Experiment 09-05_06:33
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 601.770600 | MAPE 2.812075 | RMSE 0.909868 | Likelihood -600.139191 | KL fp 1.6314 | FP STD 0.3023 | ->nfe  188.00 | <-nfe  188.00
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 4.729697 | RMSE 0.846169 | MAE 0.785272 |
Best Val!
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 2.575697 | RMSE 1.513113| MAE 1.257807|
2.8664729595184326,0.7960215210914612,0.6701575517654419,18.693496704101562,1.5501961708068848,0.6833786368370056,2.1908397674560547,1.6206066608428955,2.309718370437622,4.241288661956787,2.4872827529907227,1.454077124595642,0.5795485377311707,0.3807370662689209,9.336465835571289,2.3777523040771484,1.3049591779708862,3.580629825592041,0.8287073373794556,0.9419645667076111,0.5015479922294617,1.4199342727661133,0.6342751383781433,0.7926132678985596,0.6876888871192932,10.610564231872559,0.8779028058052063,1.8916475772857666,0.40409788489341736,0.5563479661941528
1.5453701212971913,1.4584357725222705,0.8799610844048651,1.5175633570911116,1.3076213355137485,1.3938543562887427,1.5778394384081025,1.5524540486192628,1.568347821602838,1.3449694400988466,1.7255630016691632,1.502173994117494,1.2996210187752126,1.4873503729954016,1.4452431327050912,1.1980189680562536,1.61372565182402,2.0856078383871672,1.4719525586081539,1.374231947618082,1.3952634796382741,1.5595935492555086,1.7155320300428394,1.913011036332037,1.585792497291863,2.2248959377685344,1.4734897025803164,1.6348909719669737,1.2691683206445175,1.2718374579510254
Experiment 09-05_06:33
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 513.338764 | MAPE 2.595664 | RMSE 0.868227 | Likelihood -511.693865 | KL fp 1.6449 | FP STD 0.3806 | ->nfe  188.00 | <-nfe  188.00
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 3.670115 | RMSE 0.883983 | MAE 0.768154 |
Best Val!
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 2.783572 | RMSE 1.336570| MAE 1.094359|
1.2500931024551392,2.106093406677246,1.2242025136947632,13.955322265625,1.0460981130599976,0.780087947845459,1.5446772575378418,0.7259950637817383,0.8335874676704407,6.746730327606201,1.5568450689315796,2.356454849243164,0.6463930010795593,0.34138697385787964,8.775137901306152,1.7187426090240479,0.9182144999504089,3.7744224071502686,0.847075879573822,1.5003129243850708,0.3637467920780182,0.6579477787017822,0.4775264263153076,0.4030853807926178,0.6309916973114014,24.82302474975586,1.0835517644882202,1.1380537748336792,0.367999404668808,0.9133545756340027
1.6681463428445449,1.515184240060031,1.1482526150272292,1.4033775238288957,1.5044690156727265,1.344053234218295,1.2607733429384123,1.0104365527106751,1.2480439617379682,1.464270721252456,1.1443178153633646,1.371364034329138,1.5312585635821605,1.2684845350688843,1.52156922638778,1.1368961785657485,1.3586158386505605,1.468964824792916,1.1483472412348632,1.1216279461786995,1.4438844791550665,1.170623263364401,1.3059013795843768,1.005059852241258,1.795345418311202,1.6286952478979955,1.2314431343997143,1.107450077834771,1.3212179205689376,1.44902962738455
Experiment 09-05_06:33
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 512.268549 | MAPE 2.446489 | RMSE 0.879336 | Likelihood -510.565435 | KL fp 1.7031 | FP STD 0.4416 | ->nfe  188.00 | <-nfe  188.00
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 4.998065 | RMSE 0.771369 | MAE 0.733864 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 2.075621 | RMSE 1.337262| MAE 1.108418|
1.1386440992355347,0.78626549243927,0.9568671584129333,12.9762601852417,1.2159115076065063,0.5150803923606873,1.2573904991149902,1.5375902652740479,0.7898328900337219,1.2197926044464111,1.6156879663467407,3.2876393795013428,0.5957933664321899,0.31101903319358826,3.5876622200012207,1.8399403095245361,1.0061330795288086,1.915981650352478,0.8582904934883118,1.1570535898208618,0.46550750732421875,1.0801138877868652,0.49013271927833557,0.49935951828956604,0.501203715801239,16.28469467163086,1.2935997247695923,1.773905634880066,0.430934339761734,0.880335807800293
1.7170386377429592,1.2231209453813796,0.9665059278023184,1.4706437097632739,1.6391773194569867,1.230619439480116,1.4351836906388864,1.2400193876627414,1.236455395552314,1.2069567808616513,1.4658237281876425,1.544962384528356,1.4000310076958173,1.1781879519534113,0.8673925758710813,0.9591117510139655,1.0896869396211557,1.4386606092216472,1.2539822564307097,1.247934876671563,1.491339957121212,1.4678413339876675,1.3830230466393918,1.257477946836966,1.4609984522869417,1.515751469634846,1.6070976069301715,1.17749618221887,1.4061589953327946,1.539166519600132
1.1386440992355347,0.78626549243927,0.9568671584129333,12.9762601852417,1.2159115076065063,0.5150803923606873,1.2573904991149902,1.5375902652740479,0.7898328900337219,1.2197926044464111,1.6156879663467407,3.2876393795013428,0.5957933664321899,0.31101903319358826,3.5876622200012207,1.8399403095245361,1.0061330795288086,1.915981650352478,0.8582904934883118,1.1570535898208618,0.46550750732421875,1.0801138877868652,0.49013271927833557,0.49935951828956604,0.501203715801239,16.28469467163086,1.2935997247695923,1.773905634880066,0.430934339761734,0.880335807800293
1.7170386377429592,1.2231209453813796,0.9665059278023184,1.4706437097632739,1.6391773194569867,1.230619439480116,1.4351836906388864,1.2400193876627414,1.236455395552314,1.2069567808616513,1.4658237281876425,1.544962384528356,1.4000310076958173,1.1781879519534113,0.8673925758710813,0.9591117510139655,1.0896869396211557,1.4386606092216472,1.2539822564307097,1.247934876671563,1.491339957121212,1.4678413339876675,1.3830230466393918,1.257477946836966,1.4609984522869417,1.515751469634846,1.6070976069301715,1.17749618221887,1.4061589953327946,1.539166519600132
Epoch 0006 [Test seq (cond on sampled tp)] | Best Test MAPE 2.075621|Best Test RMSE 1.337262|Best Test MAE 1.108418|
Experiment 09-05_06:33
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 487.886202 | MAPE 2.497913 | RMSE 0.830864 | Likelihood -486.389536 | KL fp 1.4967 | FP STD 0.4864 | ->nfe  188.00 | <-nfe  188.00
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 3.121710 | RMSE 0.746643 | MAE 0.719119 |
Best Val!
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 2.040020 | RMSE 1.290824| MAE 1.070210|
1.938589334487915,2.190202474594116,0.9359061121940613,14.50793743133545,1.4109607934951782,0.601111650466919,1.890607237815857,0.8468974232673645,1.5085567235946655,1.5268598794937134,1.6507221460342407,1.5890029668807983,0.5643880367279053,0.3204408884048462,3.0450186729431152,1.4805206060409546,1.1416904926300049,4.073598384857178,0.7506327629089355,1.3853524923324585,0.43181392550468445,1.224125862121582,0.4906170964241028,0.5418596267700195,0.4452632963657379,11.233562469482422,1.2365773916244507,1.3516180515289307,0.33098044991493225,0.5551861524581909
1.497028108861662,1.4624575290870996,0.8075220866179599,1.3482132797093098,1.416241900024415,1.0640911081644322,1.2767781629920234,1.0772719394577066,1.4618657880723613,1.2017293489291578,1.3243989174858284,1.5908281807327287,1.361119652524518,1.2465017003714558,1.0439322946305978,1.0993829361898597,1.4108072400294778,1.6472936340657351,1.038614621114115,1.1356762172337325,1.2463042939353395,1.3823874730952133,1.5444048801373669,1.2518894221007888,1.320713185562858,1.4191371843131977,1.276310540761313,1.2317665643060218,1.4620450151665272,1.078001319314719
1.938589334487915,2.190202474594116,0.9359061121940613,14.50793743133545,1.4109607934951782,0.601111650466919,1.890607237815857,0.8468974232673645,1.5085567235946655,1.5268598794937134,1.6507221460342407,1.5890029668807983,0.5643880367279053,0.3204408884048462,3.0450186729431152,1.4805206060409546,1.1416904926300049,4.073598384857178,0.7506327629089355,1.3853524923324585,0.43181392550468445,1.224125862121582,0.4906170964241028,0.5418596267700195,0.4452632963657379,11.233562469482422,1.2365773916244507,1.3516180515289307,0.33098044991493225,0.5551861524581909
1.497028108861662,1.4624575290870996,0.8075220866179599,1.3482132797093098,1.416241900024415,1.0640911081644322,1.2767781629920234,1.0772719394577066,1.4618657880723613,1.2017293489291578,1.3243989174858284,1.5908281807327287,1.361119652524518,1.2465017003714558,1.0439322946305978,1.0993829361898597,1.4108072400294778,1.6472936340657351,1.038614621114115,1.1356762172337325,1.2463042939353395,1.3823874730952133,1.5444048801373669,1.2518894221007888,1.320713185562858,1.4191371843131977,1.276310540761313,1.2317665643060218,1.4620450151665272,1.078001319314719
Epoch 0007 [Test seq (cond on sampled tp)] | Best Test MAPE 2.040020|Best Test RMSE 1.290824|Best Test MAE 1.070210|
Experiment 09-05_06:33
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 487.286977 | MAPE 2.417062 | RMSE 0.848737 | Likelihood -485.718854 | KL fp 1.5681 | FP STD 0.4735 | ->nfe  188.00 | <-nfe  188.00
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 4.775102 | RMSE 0.901876 | MAE 0.812198 |
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 2.061439 | RMSE 1.367195| MAE 1.146351|
1.7347744703292847,1.1527855396270752,0.7309728264808655,11.842836380004883,1.4277470111846924,0.747417151927948,2.600738286972046,1.2193998098373413,1.1049408912658691,2.731884717941284,2.016106367111206,0.9723252654075623,0.5092763304710388,0.427651971578598,5.406591415405273,1.471968173980713,0.9414089322090149,2.0361974239349365,0.5638567805290222,1.4048724174499512,0.4361127018928528,1.084088921546936,0.4818902015686035,0.5471767783164978,0.49650493264198303,13.678827285766602,1.195045828819275,1.690123438835144,0.469741553068161,0.7199050188064575
1.4906048595419374,1.4551615236691222,0.6929096751530353,1.4512703658062334,1.634147353939233,1.3250640601740973,1.3633656298038306,1.3286290726850039,1.3898423810826679,1.3878144998928985,1.5627326792085265,1.395856254541269,1.1853407754499956,1.710525184314369,1.3210041559429764,1.082622435431619,1.2728193690215086,1.904511706631976,0.8606704657796056,1.4808352376610414,1.1871426195144743,1.1967643447599585,1.462483857546672,1.371143568389134,1.3957527858590857,1.5008403490415485,1.4671036441389798,1.3628466331442866,1.6678608272041522,1.1081704598454318
