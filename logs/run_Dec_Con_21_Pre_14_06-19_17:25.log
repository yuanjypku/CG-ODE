/nvme/yuanjingyang/CG-ODE/run_models_covid.py
run_models_covid.py
Namespace(save='experiments/', load=None, dataset='Dec', datapath='data/', pred_length=14, condition_length=21, features='Confirmed,Deaths,Recovered,Mortality_Rate,Testing_Rate,Population,Mobility', split_interval=3, feature_out='Deaths', niters=100, lr=0.005, batch_size=8, random_seed=1991, dropout=0.2, l2=1e-05, optimizer='AdamW', clip=10, edge_lamda=0.5, z0_encoder='GTrans', rec_dims=64, ode_dims=20, rec_layers=1, gen_layers=1, augment_dim=0, solver='rk4', alias='run', output_dim=1, feature_out_index=[1], num_atoms=50, heavyBall=False)
run
Experiment 06-19_17:25
Epoch 0001 [Train seq (cond on sampled tp)] | Loss 4390895.886342 | MAPE 0.063296 | RMSE 286.214713 | Likelihood -4390894.535590 | KL fp 1.3508 | FP STD 0.4945|
Epoch 0001 [Val seq (cond on sampled tp)] |  MAPE 0.058127 | RMSE 304.541843 |
Best Val!
Epoch 0001 [Test seq (cond on sampled tp)] | MAPE 0.119556 | RMSE 903.784194|
0.1317373812198639,0.12383309006690979,0.10309656709432602
848.6126913969647,934.8288279145012,927.9110612014495
0.1317373812198639,0.12383309006690979,0.10309656709432602
848.6126913969647,934.8288279145012,927.9110612014495
Epoch 0001 [Test seq (cond on sampled tp)] | Best Test MAPE 0.119556|Best Test RMSE 903.784194|
Experiment 06-19_17:25
Epoch 0002 [Train seq (cond on sampled tp)] | Loss 4160151.740977 | MAPE 0.102152 | RMSE 274.597860 | Likelihood -4160148.913299 | KL fp 2.8277 | FP STD 0.9131|
Epoch 0002 [Val seq (cond on sampled tp)] |  MAPE 0.064211 | RMSE 277.289715 |
Epoch 0002 [Test seq (cond on sampled tp)] | MAPE 0.107863 | RMSE 858.711348|
0.11698845773935318,0.10953818261623383,0.0970609188079834
799.9341769795813,888.0060177160964,888.1938484925462
0.11698845773935318,0.10953818261623383,0.0970609188079834
799.9341769795813,888.0060177160964,888.1938484925462
Epoch 0002 [Test seq (cond on sampled tp)] | Best Test MAPE 0.107863|Best Test RMSE 858.711348|
Experiment 06-19_17:25
Epoch 0003 [Train seq (cond on sampled tp)] | Loss 3781629.446366 | MAPE 0.245080 | RMSE 253.899207 | Likelihood -3781624.029492 | KL fp 5.4169 | FP STD 1.1876|
Epoch 0003 [Val seq (cond on sampled tp)] |  MAPE 0.102948 | RMSE 234.444906 |
Epoch 0003 [Test seq (cond on sampled tp)] | MAPE 0.137277 | RMSE 771.899625|
0.14401890337467194,0.1420316994190216,0.1257818341255188
709.5534246975346,801.8188698203604,804.326581681844
Experiment 06-19_17:25
Epoch 0004 [Train seq (cond on sampled tp)] | Loss 3443448.310195 | MAPE 0.442077 | RMSE 232.983521 | Likelihood -3443441.949413 | KL fp 6.3608 | FP STD 1.0278|
Epoch 0004 [Val seq (cond on sampled tp)] |  MAPE 0.071025 | RMSE 199.547075 |
Epoch 0004 [Test seq (cond on sampled tp)] | MAPE 0.101389 | RMSE 704.857010|
0.10506218671798706,0.09939312934875488,0.09971070289611816
638.6325723763234,734.7855129219682,741.1529447421767
0.10506218671798706,0.09939312934875488,0.09971070289611816
638.6325723763234,734.7855129219682,741.1529447421767
Epoch 0004 [Test seq (cond on sampled tp)] | Best Test MAPE 0.101389|Best Test RMSE 704.857010|
Experiment 06-19_17:25
Epoch 0005 [Train seq (cond on sampled tp)] | Loss 3009354.639108 | MAPE 0.177459 | RMSE 204.985138 | Likelihood -3009351.388406 | KL fp 3.2507 | FP STD 0.6329|
Epoch 0005 [Val seq (cond on sampled tp)] |  MAPE 0.028762 | RMSE 162.137739 |
Best Val!
Epoch 0005 [Test seq (cond on sampled tp)] | MAPE 0.060715 | RMSE 615.491946|
0.06209607794880867,0.0634789913892746,0.05656922236084938
549.1731568913397,650.9427778230587,646.3599036140779
0.06209607794880867,0.0634789913892746,0.05656922236084938
549.1731568913397,650.9427778230587,646.3599036140779
Epoch 0005 [Test seq (cond on sampled tp)] | Best Test MAPE 0.060715|Best Test RMSE 615.491946|
Experiment 06-19_17:25
Epoch 0006 [Train seq (cond on sampled tp)] | Loss 2667717.709328 | MAPE 0.040919 | RMSE 177.716560 | Likelihood -2667714.080573 | KL fp 3.6288 | FP STD 0.6141|
Epoch 0006 [Val seq (cond on sampled tp)] |  MAPE 0.032505 | RMSE 140.250877 |
Epoch 0006 [Test seq (cond on sampled tp)] | MAPE 0.055423 | RMSE 525.370626|
0.06042468547821045,0.05726863071322441,0.04857528954744339
446.4938234455209,569.4252859243256,560.1927681611037
0.06042468547821045,0.05726863071322441,0.04857528954744339
446.4938234455209,569.4252859243256,560.1927681611037
Epoch 0006 [Test seq (cond on sampled tp)] | Best Test MAPE 0.055423|Best Test RMSE 525.370626|
Experiment 06-19_17:25
Epoch 0007 [Train seq (cond on sampled tp)] | Loss 2348405.757126 | MAPE 0.041812 | RMSE 147.988835 | Likelihood -2348402.606148 | KL fp 3.1510 | FP STD 0.5015|
Epoch 0007 [Val seq (cond on sampled tp)] |  MAPE 0.030554 | RMSE 117.778763 |
Epoch 0007 [Test seq (cond on sampled tp)] | MAPE 0.055072 | RMSE 478.317617|
0.05607068911194801,0.06209351494908333,0.047051411122083664
401.73946003597905,517.662836699719,515.5505552319772
0.05607068911194801,0.06209351494908333,0.047051411122083664
401.73946003597905,517.662836699719,515.5505552319772
Epoch 0007 [Test seq (cond on sampled tp)] | Best Test MAPE 0.055072|Best Test RMSE 478.317617|
Experiment 06-19_17:25
Epoch 0008 [Train seq (cond on sampled tp)] | Loss 2239992.214448 | MAPE 0.041734 | RMSE 134.825394 | Likelihood -2239989.203804 | KL fp 3.0106 | FP STD 0.4114|
Epoch 0008 [Val seq (cond on sampled tp)] |  MAPE 0.029172 | RMSE 102.574677 |
Epoch 0008 [Test seq (cond on sampled tp)] | MAPE 0.049571 | RMSE 391.977011|
0.05352549999952316,0.051173195242881775,0.04401395842432976
328.36578070423235,417.10681335840104,430.4584402122927
0.05352549999952316,0.051173195242881775,0.04401395842432976
328.36578070423235,417.10681335840104,430.4584402122927
Epoch 0008 [Test seq (cond on sampled tp)] | Best Test MAPE 0.049571|Best Test RMSE 391.977011|
Experiment 06-19_17:25
Epoch 0009 [Train seq (cond on sampled tp)] | Loss 2135560.807390 | MAPE 0.039593 | RMSE 121.970030 | Likelihood -2135557.765991 | KL fp 3.0414 | FP STD 0.3358|
Epoch 0009 [Val seq (cond on sampled tp)] |  MAPE 0.036148 | RMSE 97.767282 |
Epoch 0009 [Test seq (cond on sampled tp)] | MAPE 0.056318 | RMSE 375.175386|
0.053318459540605545,0.05675794556736946,0.05887863412499428
312.08861672207786,399.20794628238554,414.22959364342864
Experiment 06-19_17:25
Epoch 0010 [Train seq (cond on sampled tp)] | Loss 2117907.528357 | MAPE 0.054759 | RMSE 119.287479 | Likelihood -2117904.557048 | KL fp 2.9713 | FP STD 0.3286|
Epoch 0010 [Val seq (cond on sampled tp)] |  MAPE 0.025294 | RMSE 99.037186 |
Best Val!
Epoch 0010 [Test seq (cond on sampled tp)] | MAPE 0.054434 | RMSE 356.643409|
0.057531315833330154,0.05816175416111946,0.04760975390672684
302.41553572857333,372.0465150690166,395.4681758688049
Experiment 06-19_17:25
Epoch 0011 [Train seq (cond on sampled tp)] | Loss 2082851.325461 | MAPE 0.046419 | RMSE 114.814225 | Likelihood -2082848.349111 | KL fp 2.9763 | FP STD 0.3142|
Epoch 0011 [Val seq (cond on sampled tp)] |  MAPE 0.042939 | RMSE 89.363035 |
Epoch 0011 [Test seq (cond on sampled tp)] | MAPE 0.063436 | RMSE 330.356682|
0.06445018202066422,0.05993996933102608,0.06591896712779999
267.89066099810196,337.5843297422142,385.5950555634758
Experiment 06-19_17:25
Epoch 0012 [Train seq (cond on sampled tp)] | Loss 2052786.683598 | MAPE 0.035840 | RMSE 112.208855 | Likelihood -2052783.717630 | KL fp 2.9660 | FP STD 0.2627|
Epoch 0012 [Val seq (cond on sampled tp)] |  MAPE 0.032724 | RMSE 81.831226 |
Epoch 0012 [Test seq (cond on sampled tp)] | MAPE 0.060837 | RMSE 305.150917|
0.05812244117259979,0.06110604479908943,0.0632837638258934
240.16783682198164,322.73712212883106,352.54779152974425
Experiment 06-19_17:25
Epoch 0013 [Train seq (cond on sampled tp)] | Loss 2040424.773515 | MAPE 0.034690 | RMSE 109.150983 | Likelihood -2040421.447577 | KL fp 3.3259 | FP STD 0.2414|
Epoch 0013 [Val seq (cond on sampled tp)] |  MAPE 0.025951 | RMSE 87.872780 |
Epoch 0013 [Test seq (cond on sampled tp)] | MAPE 0.046998 | RMSE 332.225253|
0.04269669950008392,0.05052832514047623,0.047767654061317444
262.4692392690999,361.4952130561344,372.7113075156159
0.04269669950008392,0.05052832514047623,0.047767654061317444
262.4692392690999,361.4952130561344,372.7113075156159
Epoch 0013 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046998|Best Test RMSE 332.225253|
Experiment 06-19_17:25
Epoch 0014 [Train seq (cond on sampled tp)] | Loss 2028435.659845 | MAPE 0.041231 | RMSE 108.767587 | Likelihood -2028432.430794 | KL fp 3.2291 | FP STD 0.2450|
Epoch 0014 [Val seq (cond on sampled tp)] |  MAPE 0.030057 | RMSE 89.912800 |
Epoch 0014 [Test seq (cond on sampled tp)] | MAPE 0.053559 | RMSE 316.241918|
0.05642136558890343,0.05662992224097252,0.047625549137592316
235.50138501450473,339.18722936233905,374.03713886457854
Experiment 06-19_17:25
Epoch 0015 [Train seq (cond on sampled tp)] | Loss 2023427.811060 | MAPE 0.036974 | RMSE 108.065910 | Likelihood -2023424.811567 | KL fp 2.9995 | FP STD 0.2811|
Epoch 0015 [Val seq (cond on sampled tp)] |  MAPE 0.025421 | RMSE 94.885478 |
Epoch 0015 [Test seq (cond on sampled tp)] | MAPE 0.054317 | RMSE 313.456674|
0.05824373662471771,0.05626680701971054,0.048439063131809235
237.87038553064986,339.93893063681304,362.5607061238159
Experiment 06-19_17:25
Epoch 0016 [Train seq (cond on sampled tp)] | Loss 2009610.058358 | MAPE 0.032280 | RMSE 106.259842 | Likelihood -2009606.958745 | KL fp 3.0996 | FP STD 0.2251|
Epoch 0016 [Val seq (cond on sampled tp)] |  MAPE 0.029204 | RMSE 94.320473 |
Epoch 0016 [Test seq (cond on sampled tp)] | MAPE 0.058391 | RMSE 295.054849|
0.061831600964069366,0.057132065296173096,0.05620826780796051
223.91376688359293,307.3223572244623,353.9284223186943
Experiment 06-19_17:25
Epoch 0017 [Train seq (cond on sampled tp)] | Loss 2005215.945433 | MAPE 0.047061 | RMSE 104.336995 | Likelihood -2005212.642518 | KL fp 3.3029 | FP STD 0.1874|
Epoch 0017 [Val seq (cond on sampled tp)] |  MAPE 0.028181 | RMSE 89.162050 |
Epoch 0017 [Test seq (cond on sampled tp)] | MAPE 0.062222 | RMSE 307.226890|
0.06383637338876724,0.06362272799015045,0.05920550227165222
248.65793679520868,340.27318987836816,332.74954216722824
Experiment 06-19_17:25
Epoch 0018 [Train seq (cond on sampled tp)] | Loss 1974918.000899 | MAPE 0.034777 | RMSE 100.717175 | Likelihood -1974914.862011 | KL fp 3.1389 | FP STD 0.1965|
Epoch 0018 [Val seq (cond on sampled tp)] |  MAPE 0.034517 | RMSE 90.409145 |
Epoch 0018 [Test seq (cond on sampled tp)] | MAPE 0.069819 | RMSE 291.848664|
0.06753146648406982,0.06886926293373108,0.0730564221739769
227.5494623428058,296.9365067863835,351.06002424799095
Experiment 06-19_17:25
Epoch 0019 [Train seq (cond on sampled tp)] | Loss 1945226.053039 | MAPE 0.030492 | RMSE 94.144122 | Likelihood -1945222.804371 | KL fp 3.2487 | FP STD 0.1871|
Epoch 0019 [Val seq (cond on sampled tp)] |  MAPE 0.021701 | RMSE 88.497410 |
Best Val!
Epoch 0019 [Test seq (cond on sampled tp)] | MAPE 0.050384 | RMSE 301.377922|
0.050744567066431046,0.05371192842721939,0.04669623821973801
233.86077756060334,318.4211907010901,351.85179763644805
Experiment 06-19_17:25
Epoch 0020 [Train seq (cond on sampled tp)] | Loss 1935006.951413 | MAPE 0.032357 | RMSE 93.311051 | Likelihood -1935003.819360 | KL fp 3.1321 | FP STD 0.1999|
Epoch 0020 [Val seq (cond on sampled tp)] |  MAPE 0.020844 | RMSE 77.670311 |
Best Val!
Epoch 0020 [Test seq (cond on sampled tp)] | MAPE 0.052168 | RMSE 303.688796|
0.05610598623752594,0.05248218774795532,0.04791495203971863
238.00020516010065,325.74926851414415,347.3169144491814
Experiment 06-19_17:25
Epoch 0021 [Train seq (cond on sampled tp)] | Loss 1921677.290427 | MAPE 0.029576 | RMSE 91.261320 | Likelihood -1921674.301361 | KL fp 2.9891 | FP STD 0.2279|
Epoch 0021 [Val seq (cond on sampled tp)] |  MAPE 0.032359 | RMSE 81.502136 |
Epoch 0021 [Test seq (cond on sampled tp)] | MAPE 0.063709 | RMSE 284.279518|
0.06682880967855453,0.0644342452287674,0.0598645880818367
216.55420258274833,305.9434052034788,330.3409460315206
Experiment 06-19_17:25
Epoch 0022 [Train seq (cond on sampled tp)] | Loss 1965436.958674 | MAPE 0.031818 | RMSE 98.892673 | Likelihood -1965433.843294 | KL fp 3.1154 | FP STD 0.1887|
Epoch 0022 [Val seq (cond on sampled tp)] |  MAPE 0.037307 | RMSE 83.960652 |
Epoch 0022 [Test seq (cond on sampled tp)] | MAPE 0.065966 | RMSE 297.956441|
0.06523772329092026,0.0678248330950737,0.06483530253171921
229.35967251241007,316.8344032179902,347.67524807641973
Experiment 06-19_17:25
Epoch 0023 [Train seq (cond on sampled tp)] | Loss 1940926.111974 | MAPE 0.033542 | RMSE 94.809192 | Likelihood -1940923.080303 | KL fp 3.0317 | FP STD 0.2220|
Epoch 0023 [Val seq (cond on sampled tp)] |  MAPE 0.031503 | RMSE 92.464251 |
Epoch 0023 [Test seq (cond on sampled tp)] | MAPE 0.064657 | RMSE 317.149826|
0.06932631134986877,0.06437534838914871,0.060270071029663086
278.0555109820699,342.0223631211854,331.3716050373055
Experiment 06-19_17:25
Epoch 0024 [Train seq (cond on sampled tp)] | Loss 1962057.630706 | MAPE 0.056680 | RMSE 97.062947 | Likelihood -1962054.376856 | KL fp 3.2538 | FP STD 0.1790|
Epoch 0024 [Val seq (cond on sampled tp)] |  MAPE 0.035014 | RMSE 91.859592 |
Epoch 0024 [Test seq (cond on sampled tp)] | MAPE 0.065897 | RMSE 279.010963|
0.06373295187950134,0.06362338364124298,0.07033530622720718
227.58754325259105,286.5247998646889,322.92054701969647
Experiment 06-19_17:25
Epoch 0025 [Train seq (cond on sampled tp)] | Loss 1930741.811721 | MAPE 0.032462 | RMSE 93.052329 | Likelihood -1930738.732089 | KL fp 3.0796 | FP STD 0.1859|
Epoch 0025 [Val seq (cond on sampled tp)] |  MAPE 0.039567 | RMSE 80.659156 |
Epoch 0025 [Test seq (cond on sampled tp)] | MAPE 0.069947 | RMSE 271.848433|
0.07045229524374008,0.06683839857578278,0.0725502222776413
207.6290073364028,289.3698973632192,318.54639330480575
Experiment 06-19_17:25
Epoch 0026 [Train seq (cond on sampled tp)] | Loss 1941377.148151 | MAPE 0.060659 | RMSE 93.602609 | Likelihood -1941373.898177 | KL fp 3.2500 | FP STD 0.1765|
Epoch 0026 [Val seq (cond on sampled tp)] |  MAPE 0.022024 | RMSE 76.760178 |
Epoch 0026 [Test seq (cond on sampled tp)] | MAPE 0.049461 | RMSE 282.379961|
0.052484843879938126,0.051314812153577805,0.044582050293684006
212.54868927495178,301.61843393184705,332.97276071024186
Experiment 06-19_17:25
Epoch 0027 [Train seq (cond on sampled tp)] | Loss 1950439.885465 | MAPE 0.041703 | RMSE 95.280611 | Likelihood -1950436.651584 | KL fp 3.2339 | FP STD 0.2098|
Epoch 0027 [Val seq (cond on sampled tp)] |  MAPE 0.026399 | RMSE 85.109015 |
Epoch 0027 [Test seq (cond on sampled tp)] | MAPE 0.057143 | RMSE 265.379651|
0.057488176971673965,0.05638650432229042,0.05755464360117912
223.94420691882164,274.2591013758705,297.93564479179054
Experiment 06-19_17:25
Epoch 0028 [Train seq (cond on sampled tp)] | Loss 1952341.819567 | MAPE 0.031677 | RMSE 96.649532 | Likelihood -1952338.845184 | KL fp 2.9744 | FP STD 0.2016|
Epoch 0028 [Val seq (cond on sampled tp)] |  MAPE 0.023935 | RMSE 81.395765 |
Epoch 0028 [Test seq (cond on sampled tp)] | MAPE 0.049014 | RMSE 278.590597|
0.05263799428939819,0.04967755079269409,0.04472574219107628
245.2020770583928,287.2438532849746,303.3258612861752
Experiment 06-19_17:25
Epoch 0029 [Train seq (cond on sampled tp)] | Loss 1979828.147803 | MAPE 0.049391 | RMSE 99.735292 | Likelihood -1979824.911509 | KL fp 3.2363 | FP STD 0.2490|
Epoch 0029 [Val seq (cond on sampled tp)] |  MAPE 0.023504 | RMSE 82.872590 |
Epoch 0029 [Test seq (cond on sampled tp)] | MAPE 0.055934 | RMSE 319.854902|
0.06331130117177963,0.0574791356921196,0.047011878341436386
268.81606746063375,328.4238519999727,362.3247852410872
Experiment 06-19_17:25
Epoch 0030 [Train seq (cond on sampled tp)] | Loss 1927184.518117 | MAPE 0.031658 | RMSE 94.152115 | Likelihood -1927181.513618 | KL fp 3.0045 | FP STD 0.2253|
Epoch 0030 [Val seq (cond on sampled tp)] |  MAPE 0.023893 | RMSE 84.753929 |
Epoch 0030 [Test seq (cond on sampled tp)] | MAPE 0.046448 | RMSE 285.445870|
0.05452178046107292,0.04799595847725868,0.036826614290475845
214.37214830464802,310.41981402207557,331.545646367133
0.05452178046107292,0.04799595847725868,0.036826614290475845
214.37214830464802,310.41981402207557,331.545646367133
Epoch 0030 [Test seq (cond on sampled tp)] | Best Test MAPE 0.046448|Best Test RMSE 285.445870|
Experiment 06-19_17:25
Epoch 0031 [Train seq (cond on sampled tp)] | Loss 1958295.770221 | MAPE 0.047014 | RMSE 97.799372 | Likelihood -1958292.703639 | KL fp 3.0666 | FP STD 0.2136|
Epoch 0031 [Val seq (cond on sampled tp)] |  MAPE 0.035385 | RMSE 83.474752 |
Epoch 0031 [Test seq (cond on sampled tp)] | MAPE 0.070559 | RMSE 310.065726|
0.07033262401819229,0.071083664894104,0.07026095688343048
262.9845230712256,326.3416537924633,340.8710006182691
Experiment 06-19_17:25
Epoch 0032 [Train seq (cond on sampled tp)] | Loss 1921671.498932 | MAPE 0.039365 | RMSE 91.561111 | Likelihood -1921668.387790 | KL fp 3.1111 | FP STD 0.2196|
Epoch 0032 [Val seq (cond on sampled tp)] |  MAPE 0.033412 | RMSE 89.563021 |
Epoch 0032 [Test seq (cond on sampled tp)] | MAPE 0.063827 | RMSE 318.420851|
0.06596880406141281,0.06569982320070267,0.059810932725667953
281.82212641575893,338.5439987099166,334.89642755260917
Experiment 06-19_17:25
Epoch 0033 [Train seq (cond on sampled tp)] | Loss 1938691.016165 | MAPE 0.054101 | RMSE 96.181251 | Likelihood -1938687.994703 | KL fp 3.0215 | FP STD 0.2042|
Epoch 0033 [Val seq (cond on sampled tp)] |  MAPE 0.025257 | RMSE 82.801240 |
Epoch 0033 [Test seq (cond on sampled tp)] | MAPE 0.052754 | RMSE 263.314392|
0.05694256350398064,0.04788175970315933,0.05343783646821976
212.42605331032254,252.05036544061983,325.4667561748819
